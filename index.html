<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Register</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#9b59b6">

    <style>
        /* 1. Login & Dark Mode Overrides */
        [data-theme="dark"] .pin-box {
            background-color: #1e1e1e !important;
            border: 1px solid #444 !important;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8) !important;
        }
        [data-theme="dark"] .pin-box h3,
        [data-theme="dark"] .pin-box p { color: #ffffff !important; }
        [data-theme="dark"] #pinInput {
            background-color: #2d2d2d !important;
            color: #ffffff !important;
            border: 2px solid #555 !important;
            caret-color: #ffffff !important;
        }
        [data-theme="dark"] #pinInput:focus {
            background-color: #333 !important;
            border-color: #9290C3 !important;
        }

        /* 2. DASHBOARD GRID LAYOUT (The Arch: 7-8-9 on top, 6-Total-10 bottom) */
        #statsDashboard {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important; /* 3 Columns */
            gap: 10px !important;
            padding: 10px !important;
            margin-bottom: 20px;
        }

        /* 3. CARD STYLES */
        .stat-card {
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            color: white !important; /* Always white text */
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 90px;
        }
        .stat-card:active { transform: scale(0.95); }

        /* COLORS */
        .is-total {
            background: linear-gradient(135deg, #2c3e50, #4ca1af) !important; /* Blue Gradient */
            border: 1px solid rgba(255,255,255,0.2);
            grid-column: 2; /* Forces Total to be in the center of the bottom row */
        }
        .is-active {
            background: #9b59b6 !important; /* Bright Purple */
            border: 2px solid white;
            transform: scale(1.05);
            z-index: 10;
        }
        .is-filled { background: #9b59b6 !important; opacity: 0.85; } /* Standard Purple */
        .is-normal { background: #95a5a6 !important; } /* Grey for Empty */

        /* 4. FLOATING NAV BAR */
        body { padding-bottom: 70px !important; }
        .bottom-nav {
            position: fixed !important;
            bottom: 15px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            width: 75% !important;
            max-width: 350px !important;
            height: 48px !important;
            background-color: #ffffff !important;
            display: none !important;
            justify-content: space-evenly !important;
            align-items: center !important;
            border-radius: 30px !important;
            border: 1px solid #c0c0c0 !important;
            box-shadow: 0 12px 35px rgba(0,0,0,0.25) !important;
            z-index: 9999 !important;
        }
        [data-theme="dark"] .bottom-nav {
            background-color: #2c2c2c !important;
            border: 1px solid #444 !important;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8) !important;
        }
        .nav-item {
            background: transparent !important;
            border: none !important;
            color: #999 !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            font-size: 9px !important;
            width: auto !important;
            height: 100% !important;
            padding: 0 5px !important;
            margin: 0 !important;
            cursor: pointer !important;
            position: relative !important;
        }
        .nav-icon {
            font-size: 20px !important;
            margin-bottom: 2px !important;
            display: block !important;
            transition: transform 0.2s !important;
        }
        .nav-item.active { color: #9b59b6 !important; font-weight: bold !important; }
        .nav-item.active::after {
            content: '' !important;
            position: absolute !important;
            bottom: 5px !important;
            width: 36px !important;
            height: 3px !important;
            background-color: #9b59b6 !important;
            border-radius: 10px !important;
        }
        [data-theme="dark"] .nav-item.active { color: #e0b0ff !important; }
        [data-theme="dark"] .nav-item.active::after { background-color: #e0b0ff !important; box-shadow: 0 0 6px rgba(224, 176, 255, 0.6) !important; }
        .nav-item.active .nav-icon { transform: translateY(-2px) !important; }
    </style>
</head>
<body>

<div id="pinOverlay" class="overlay">
    <div class="pin-box">
        <div class="pin-icon">üîê</div>
        <h3>Student Register</h3>
        <p class="pin-subtitle">Please enter your PIN to continue</p>
        <input type="password" id="pinInput" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="4">
        <div class="pin-buttons">
            <button onclick="checkPin('admin')" class="btn-admin">Admin</button>
            <button onclick="checkPin('guest')" class="btn-guest">Guest</button>
        </div>
    </div>
</div>

<div class="container" id="mainContent" style="display:none;">
    <div class="header">
        <h2>Student Register</h2>
        <button id="themeToggle" onclick="toggleTheme()">üåô</button>
    </div>

    <details class="admin-tools">
        <summary>‚öôÔ∏è Tools</summary>
        <div class="top-controls">
            <button onclick="exportToCSV()" class="btn-secondary">üìä</button>
            <button onclick="backupJSON()" class="btn-secondary">üì•</button>
            <button onclick="document.getElementById('importFile').click()" class="btn-secondary">üì§</button>
            <button onclick="window.print()" class="btn-secondary">üñ®Ô∏è</button>
            <button onclick="logout()" class="btn-delete">üîí</button>
            <button onclick="clearAllData()" class="btn-delete admin-only">üóëÔ∏è</button>
            <input type="file" id="importFile" style="display:none" onchange="restoreJSON(event)">
        </div>
    </details>

    <div class="dashboard" id="statsDashboard"></div>

    <details class="admin-only" id="studentFormDetails">
        <summary class="add-student-toggle">Add New Student</summary>
        <div class="input-group">
            <input type="hidden" id="editIndex">
            <input type="text" id="name" placeholder="Student Name *">
            <input type="number" id="roll" placeholder="Roll Number *">
            <select id="class">
                <option value="">Select Class</option>
                <option value="6">Class 6</option>
                <option value="7">Class 7</option>
                <option value="8">Class 8</option>
                <option value="9">Class 9</option>
                <option value="10">Class 10</option>
            </select>
            <input type="text" id="guardian" placeholder="Guardian Name">
            <input type="tel" id="phone" placeholder="Phone">
            <input type="text" id="notes" placeholder="Notes">
            <div style="display:flex; gap:10px; margin-top:10px;">
                <button id="submitBtn" onclick="saveStudent()" style="flex:2;">Add Student</button>
                <button type="button" onclick="resetForm()" style="flex:1; background:#95a5a6; border:none; color:white; border-radius:5px; cursor:pointer;">Cancel</button>
            </div>
        </div>
    </details>

    <hr>

    <div class="filter-bar">
        <input type="text" id="search" placeholder="Search..." onkeyup="displayStudents()">
        <div class="filter-row">
            <select id="filterClass" onchange="displayStudents()">
                <option value="">All Classes</option>
                <option value="6">Class 6</option>
                <option value="7">Class 7</option>
                <option value="8">Class 8</option>
                <option value="9">Class 9</option>
                <option value="10">Class 10</option>
            </select>
            <select id="sortDropdown" onchange="setSort(this.value)">
                <option value="roll">Sort: Roll No</option>
                <option value="name">Sort: Name (A-Z)</option>
            </select>
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Roll</th>
                    <th>Class</th>
                    <th>Guardian</th>
                    <th>Phone</th>
                    <th>Notes</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="studentList"></tbody>
        </table>
    </div>
</div>

<div id="toast-box">Notification Message</div>

<div class="bottom-nav">
    <button onclick="window.location.href='index.html'" class="nav-item active">
        <span class="nav-icon">üë®‚Äçüéì</span>
    </button>
    <button onclick="window.location.href='attendance.html'" class="nav-item">
        <span class="nav-icon">üìÖ</span>
    </button>
    <button onclick="window.location.href='results.html'" class="nav-item">
        <span class="nav-icon">üìä</span>
    </button>
</div>

<script src="script.js?v=1001"></script>

</body>
</html>
